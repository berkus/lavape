Installation of Lava/LavaPE
===========================

(Note that it may be easier and cheaper to
keep your Lava installation up-to-date
by checking it out and updating it from
our SourceForge CVS repository, which
always reflects the current state of the
Lava software development.)


How to install the LavaPE binary release for Linux
==================================================

Download the compressed tar file of the
LavaPE source distribution and store it
in the parent directory of the envisaged
lavape installation directory.

Uncompress it using the command

   tar xjvf lavape-<release>-linux-bin.tar.bz2

or, if your UNIX-tar command doesn't support
the "j" option:

   bunzip2 lavape-<release>-linux-bin.tar.bz2
   tar xf lavape-<release>-linux-bin.tar

Then just execute the install script:

   cd lavape
	 ./install

This script generates two program launch scripts
"lavape" and "lava" in lavape/bin which you can use
then to launch the Lava Programming Environment or
the Lava Interpreter.


How to install LavaPE from the source distribution on UNIX
==========================================================

Download the compressed tar file of the
LavaPE source distribution and store it
in the parent directory of the envisaged
lavape installation directory.

Uncompress it using the command

   tar xjvf lavape-<release>-src.tar.bz2

or, if your UNIX-tar command doesn't support
the "j" option:

   bunzip2 lavape-<release>-src.tar.bz2
   tar xf lavape-<release>-src.tar

Read lavape/INSTALL.txt for the details
and pre-requisites of a successfull
installation. (In particular, you need
to have GNU gcc/make and the developer version
of TrollTech/Qt on your Linux box; install
them from your Linux distribution CDs if necessary.
If Qt isn't installed in /usr/lib/qt3 you have to
provide an environment variable QTDIR that points
to the Qt installation directory.

Then build the LavaPE executables as follows:

   cd lavape
   make

This will take quite a while.
You will find the executables
of the Lava Programming Environment
in lavape/bin thereafter:
"LavaPE", "Lava", and "LPC".
(The Lava Precompiler "LPC" is needed
only during the build process.)

Launch "LavaPE", consult the Online Help,
open some sample programs from the
lavape/samples directory and enjoy the
unique structure editing features of LavaPE.

We'd appreciate very much if you would inform
us (e-mail: guenthk@users.sourceforge.net)
about any problems that you have encounterd
during the installation or while using
Lava/LavaPE.

But let us also know if you could successfully
install and use LavaPE. So far, we could not test Lava
on all platforms where we can build it successfully.
(Btw: We use always the most recent Qt release.)


How to install the binary release of LavaPE on Windows
======================================================

Simply launch the downloaded lavape-<rel>-win32.bin.exe file and
follow the instructions of the installer.


How to build Lava/LavaPE on Windows from the source tarball
===========================================================

This makes sense only if you have MS DevStudio 6.0 and the
(non-free, commercial) version of Qt. Set environment
variables 
   QTDIR=<Qt installation directory>
   QTR=<(Qt release without dots, e.g.: 334>
	 QTRDOT=<Qt release with dots, e.g.: 3.3.4>
and add the Qt source, include, lib, and bin directories
to the directory list under DevStudio/Options/Directories.

Use an appropriate unpacker program to unpack the Lava
source tarball to a directory of your choice, say <lavape>.

Open the DevStudio workspace
   <lavape>\src\LavaPE.dsw
and build the projects "Precompiler", "LavaPE", and "Lava"
in their debug configuration (build the "Precompiler" first).

Thereafter you can start the LavaPE.exe/Lava.exe executables
from DevStudio or from a file manager or DOS box. They are
in directory <lavape>\src\LavaPE\Debug.

Online help will work only if you copy the <lavape>\doc
directory to <lavape>\src\LavaPE.

The "AttacDemo.lava" and the corresponding Lava document file
"AttachDemo.ldoc" can be opened successfully in the Lava
interpreter only if you create a sub-directory "Components"
in <lavape>\src\LavaPE and copy <lavape>\samples\LCompoImpl.lcom
to this Components directory. (It suffices to create a
"LcompoImpl.lcom.lnk" link that points to
<lavape>\samples\LCompoImpl.lcom.)


Contents of the Lava source distribution
========================================

The lavape/src directory is subdivided into the following sub-directories
which are contained in the following sub-directories:

disco ............. makes the disco shared library (Lava-unspecific basic functionality;
                    the wx... files have been taken from wxWindows
										(see http://www.wxwidgets.org) and adapted to the needs of Lava)
Precompiler ....... makes the Lava precompiler LPC (see below)
Interpreter ....... makes the Lava Interpreter shared library (the actual Lava interpreter classes)
Lava .............. makes Lava.exe (MFC-wrapper for the interpreter)
Lava_UI ........... makes the user interface of the Lava interpreter
LavaStream ........ makes the LavaStream shared library containing the native implementation
                    of the Lava stream classes
LavaBase .......... makes the LavaBase shared library (common base classes of LavaPE and Lava)
LavaExecs ......... makes the LavaExecs shared library (the "exec view" of LavaPE)
LavaGUI ........... makes the LavaGUI shared library (GUI builder, shared by LavaPE and Lava
LavaPE ............ makes LavaPE (the Lava programming environment
                    and particularly the "declaration tree view")
LavaPE_UI ......... makes the user interface of LavaPE
wxqDocView ........ makes the wxqDocView shared library serving for document/view support;
                    has been taken from the wxWidgets toolkit ( http://www.wxwidgets.org)
										and adapted to the needs of Qt and Lava
SFLsockets ........ makes the socket support library for the debugger communication between
                    LavaPe and Lava; has been taken and adapted from the Standard Function Library
										(see http://www.imatix.com/html/sfl/)

The Lava Precompiler LPC
========================

This has been "inherited" from a precursor project "DISCO"
(a development environment for distributed applications
with particular support for form-based workflow applications
and digital signatures for structured data (particularly "forms").

It is used in Lava only to produce serialization/deserialization
procedures for Lava programs: Lava programs are represented internally
as "abstract syntax trees" (AST). ASTs are stored in files using
a CCITT ASN.1 encoding. The C++ data types of the AST are defined
in disco\Syntax.ph (Lava declarations) and LavaExecs\Constructs.ph
(Lava executable code) using "precompiler macros".

LPC.exe translates these into regular C++ class declarations (in disco\Syntax.h)
and ASN.1 coding/decoding procedures "CDP<type-name>" (in disco\SyntaxG.cpp
and LavaExecs\ConstructsG.cpp). Constructs.ph is supplemented by Tokens.ph
which deals with the "terminal symbols" or "tokens" of the Lava executable
constructs.

So if you change the AST structure described by Syntax.ph, Constructs.ph,
and Tokens.ph then LPC is invoked subsequently to produce new *.h/*G.cpp
files.

Incompatible changes of the AST structure should be avoided, however,
if possible, since they are likely to break existing Lava programs.

In the past we couldn't completely avoid such changes and have inserted
migration code for automatic upgrades of existing Lava programs manually
in SyntaxG.cpp and ConstructsG.cpp. This migration code is executed if
an older release of a Lava program is read from a *.lava file. The
release is stored as an integer at the beginning of the file and tested
by the above-mentioned migration code. (Look for "Release" in the *G.cpp
sources.) We keep backup copies (called *G_.cpp) of these *G.cpp files
as a safeguard against inadvertent replacement by LPC.exe.

The new Qt-based portable version of Lava/LavaPE is still free of such
migration code.

